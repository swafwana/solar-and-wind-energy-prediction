<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Complaints</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables CSS -->
  <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h3 class="mb-4">My Sent Complaints</h3>

    <!-- Date Filter Inputs -->
    <div class="row mb-3">
      <div class="col-md-4">
        <label for="fromDate" class="form-label">From Date</label>
        <input type="date" id="fromDate" name="fromDate" class="form-control">
      </div>
      <div class="col-md-4">
        <label for="toDate" class="form-label">To Date</label>
        <input type="date" id="toDate" name="toDate" class="form-control">
      </div>
    </div>

    <!-- Complaints Table -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover" id="complaintTable">
        <thead class="table-light">
          <tr>
            <th>Sl. No.</th>
            <th>Date</th>
            <th>From</th>
            <th>Complaint</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <!-- Sample Data Rows -->
          <tr>
            <td>1</td>
            <td>2025-07-25</td>
            <td>MG Road</td>
            <td>Water leakage near street 12</td>
            <td>Pending</td>
            <td><button class="btn btn-sm btn-primary">Reply</button></td>
          </tr>
          <tr>
            <td>2</td>
            <td>2025-07-20</td>
            <td>Anna Nagar</td>
            <td>Streetlight not working</td>
            <td>Resolved</td>
            <td><button class="btn btn-sm btn-primary">Reply</button></td>
          </tr>
          <tr>
            <td>3</td>
            <td>2025-07-18</td>
            <td>Kaloor</td>
            <td>Garbage not collected</td>
            <td>Rejected</td>
            <td><button class="btn btn-sm btn-primary">Reply</button></td>
          </tr>
          <!-- Add more rows as needed -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

  <script>
    // Extend DataTables with custom date filtering
    $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
      const min = document.getElementById('fromDate').value;
      const max = document.getElementById('toDate').value;
      const dateStr = data[1]; // Date is column index 1
      const date = new Date(dateStr);

      const minDate = min ? new Date(min) : null;
      const maxDate = max ? new Date(max) : null;

      if ((!minDate || date >= minDate) && (!maxDate || date <= maxDate)) {
        return true;
      }
      return false;
    });

    // Initialize DataTable and bind filter events
    $(document).ready(function () {
      const table = $('#complaintTable').DataTable({
        pageLength: 5
      });

      $('#fromDate, #toDate').on('change', function () {
        table.draw();
      });
    });
  </script>
</body>
</html>
